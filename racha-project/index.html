<!DOCTYPE html>
<html lang="ka">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Racha Map - Pro Auth</title>
    
    <script src='https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css' rel='stylesheet' />
    <script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v5.0.0/mapbox-gl-geocoder.min.js'></script>
    <link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v5.0.0/mapbox-gl-geocoder.css' type='text/css' />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet" />

    <style>
        @import url('https://fonts.cdnfonts.com/css/sf-pro-display');
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Georgian:wght@100..900&display=swap');

        :root {
            --glass: rgba(10, 10, 10, 0.45); 
            --border: rgba(255, 255, 255, 0.12);
            --text: #ffffff;
            --font-geo: "Noto Sans Georgian", sans-serif;
        }

        body { margin: 0; padding: 0; font-family: var(--font-geo) !important; background: #000; overflow: hidden; }
        #map { position: absolute; top: 0; bottom: 0; width: 100%; z-index: 1; }
        .mapboxgl-ctrl-bottom-left, .mapboxgl-ctrl-bottom-right { display: none !important; }

        /* --- UI Elements --- */
        .side-controls { position: absolute; top: 20px; left: 15px; z-index: 10; display: flex; flex-direction: column; gap: 10px; }
        .right-controls { position: absolute; top: 20px; right: 15px; z-index: 10; display: flex; flex-direction: column; gap: 10px; }
        .btn-circle { width: 36px; height: 36px; border-radius: 50%; background: var(--glass); backdrop-filter: blur(25px); border: 0.5px solid var(--border); color: var(--text); cursor: pointer; display: flex; align-items: center; justify-content: center; transition: 0.3s; }
        .btn-circle.active { background: rgba(52, 199, 89, 0.45); }

        /* --- Login Modal --- */
        #authModal {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 300px; padding: 30px; border-radius: 24px;
            background: var(--glass); backdrop-filter: blur(50px); border: 0.5px solid var(--border);
            z-index: 100; display: none; flex-direction: column; gap: 15px; color: #fff;
        }
        .modal-input {
            background: rgba(255,255,255,0.05); border: 0.5px solid var(--border);
            border-radius: 12px; padding: 12px; color: #fff; outline: none; font-size: 13px;
        }
        .modal-btn {
            background: #fff; color: #000; border: none; padding: 12px; border-radius: 12px;
            font-weight: 700; cursor: pointer; transition: 0.3s;
        }
        .modal-btn:hover { opacity: 0.8; }

        /* --- Main Bar --- */
        .main-bar {
            position: absolute; top: 20px; left: 50%; transform: translateX(-50%);
            z-index: 10; display: flex; align-items: center; gap: 15px;
            background: var(--glass); backdrop-filter: blur(40px);
            padding: 5px 15px; border-radius: 100px; border: 0.5px solid var(--border);
        }
    </style>
</head>
<body>

    <div id="map"></div>

    <div class="right-controls">
        <button class="btn-circle" onclick="toggleAuth()"><span class="material-symbols-outlined">person</span></button>
        <button class="btn-circle" id="langBtn" onclick="toggleLanguage()" style="font-size: 10px; font-weight: 700;">GE</button>
    </div>

    <div id="authModal">
        <h3 id="authTitle" style="margin:0; font-size: 18px;">·É®·Éî·É°·Éï·Éö·Éê</h3>
        <input type="email" id="email" class="modal-input" placeholder="·Éî·Éö-·É§·Éù·É°·É¢·Éê">
        <input type="password" id="password" class="modal-input" placeholder="·Éû·Éê·É†·Éù·Éö·Éò">
        <button class="modal-btn" onclick="handleAuth()">·Éì·Éê·Éì·Éê·É°·É¢·É£·É†·Éî·Éë·Éê</button>
        <p style="font-size: 10px; opacity: 0.6; text-align: center; cursor: pointer;" onclick="switchAuth()">·Éê·É† ·Éí·Éê·É•·Éï·É° ·Éê·É•·Éê·É£·Éú·Éó·Éò? ·É†·Éî·Éí·Éò·É°·É¢·É†·Éê·É™·Éò·Éê</p>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";

        // üèîÔ∏è ·É®·Éî·Éú·Éò Firebase Config
        const firebaseConfig = {
            apiKey: "AIzaSyAJbHfM7kT614kX9DBegyMQn1zALl6m23c",
            authDomain: "racha-map.firebaseapp.com",
            projectId: "racha-map",
            storageBucket: "racha-map.firebasestorage.app",
            messagingSenderId: "240476452622",
            appId: "1:240476452622:web:c63b9a525740e235b3095f",
            measurementId: "G-R1YEF831KD"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        let isLogin = true;

        window.toggleAuth = () => {
            const modal = document.getElementById('authModal');
            modal.style.display = modal.style.display === 'flex' ? 'none' : 'flex';
        };

        window.switchAuth = () => {
            isLogin = !isLogin;
            document.getElementById('authTitle').innerText = isLogin ? '·É®·Éî·É°·Éï·Éö·Éê' : '·É†·Éî·Éí·Éò·É°·É¢·É†·Éê·É™·Éò·Éê';
        };

        window.handleAuth = async () => {
            const email = document.getElementById('email').value;
            const pass = document.getElementById('password').value;
            try {
                if(isLogin) await signInWithEmailAndPassword(auth, email, pass);
                else await createUserWithEmailAndPassword(auth, email, pass);
                alert("·É¨·Éê·É†·Éõ·Éê·É¢·Éî·Éë·Éò·Éó ·Éí·Éê·Éú·ÉÆ·Éù·É†·É™·Éò·Éî·Éö·Éì·Éê!");
                toggleAuth();
            } catch (e) { alert("·É®·Éî·É™·Éì·Éù·Éõ·Éê: " + e.message); }
        };

        // üó∫Ô∏è Mapbox Setup
        mapboxgl.accessToken = 'pk.eyJ1Ijoic2FidWthNjI5IiwiYSI6ImNtbHBza2JqcDFjZ2EzZ3F4YjVuN3EwMmoifQ.V6q1KO4tol7QefPr8PQFxQ';
        const map = new mapboxgl.Map({ container: 'map', style: 'mapbox://styles/mapbox/satellite-streets-v12', center: [43.1481, 42.5176], zoom: 11, pitch: 60 });

        map.on('style.load', () => {
            const layers = map.getStyle().layers;
            layers.forEach(l => {
                if (l.type === 'symbol' && l.id.includes('shield')) map.setLayoutProperty(l.id, 'visibility', 'none');
            });
            if (!map.getSource('mapbox-dem')) {
                map.addSource('mapbox-dem', { 'type': 'raster-dem', 'url': 'mapbox://mapbox.mapbox-terrain-dem-v1', 'tileSize': 512 });
                map.setTerrain({ 'source': 'mapbox-dem', 'exaggeration': 1.6 });
            }
        });
    </script>
</body>
</html>
